<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR面试展示Demo</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://unpkg.com/ar.js@2.0.8/aframe/build/aframe-ar.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        accent: '#8B5CF6',
                    },
                    fontFamily: {
                        inter: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .backdrop-blur {
                backdrop-filter: blur(8px);
            }
        }
    </style>
</head>
<body class="font-inter bg-gray-900 text-white overflow-hidden h-screen">
    <!-- AR场景 -->
    <a-scene 
        vr-mode-ui="enabled: false" 
        renderer="colorManagement: true, logarithmicDepthBuffer: true"
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;">
        
        <!-- 相机 -->
        <a-camera gps-camera rotation-reader></a-camera>
        
        <!-- 标记和3D模型 -->
        <a-marker preset="hiro">
            <a-entity 
                gltf-model="#robotModel" 
                scale="0.01 0.01 0.01"
                position="0 0 0"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear">
            </a-entity>
        </a-marker>
        
        <!-- 模型资源 -->
        <a-assets>
            <a-asset-item id="robotModel" src="https://cdn.jsdelivr.net/gh/KhronosGroup/glTF-Sample-Models@master/2.0/Duck/glTF/Duck.gltf"></a-asset-item>
        </a-assets>
    </a-scene>
    
    <!-- 信息面板 -->
    <div class="fixed bottom-0 left-0 right-0 p-4 bg-black/70 backdrop-blur z-50">
        <div class="container mx-auto">
            <h1 class="text-[clamp(1.5rem,3vw,2rem)] font-bold text-primary mb-2 text-shadow">
                <i class="fa fa-cube mr-2"></i>AR交互展示
            </h1>
            <p class="text-gray-300 mb-4">
                通过摄像头对准Hiro标记卡，查看3D机器人模型。支持旋转、缩放交互。
            </p>
            <div class="flex flex-wrap gap-2 mb-2">
                <span class="px-3 py-1 bg-primary/20 text-primary rounded-full text-sm">
                    <i class="fa fa-code mr-1"></i>AR.js
                </span>
                <span class="px-3 py-1 bg-secondary/20 text-secondary rounded-full text-sm">
                    <i class="fa fa-cubes mr-1"></i>Three.js
                </span>
                <span class="px-3 py-1 bg-accent/20 text-accent rounded-full text-sm">
                    <i class="fa fa-mobile mr-1"></i>响应式
                </span>
            </div>
            <div class="flex justify-between items-center mt-4">
                <div class="flex items-center gap-4">
                    <button id="infoBtn" class="text-gray-300 hover:text-white transition-colors">
                        <i class="fa fa-info-circle"></i>
                    </button>
                    <button id="toggleARBtn" class="text-gray-300 hover:text-white transition-colors">
                        <i class="fa fa-refresh"></i>
                    </button>
                </div>
                <div class="text-xs text-gray-400">
                    <i class="fa fa-copyright mr-1"></i>2025 前端转AR演示
                </div>
            </div>
        </div>
    </div>
    
    <!-- 标记卡提示 -->
    <div id="markerHint" class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-black/60 backdrop-blur p-6 rounded-xl text-center z-40 max-w-md">
        <div class="mb-4">
            <i class="fa fa-camera text-4xl text-primary mb-3"></i>
            <h2 class="text-xl font-bold mb-2">未检测到标记</h2>
            <p class="text-gray-300">请将Hiro标记卡对准摄像头</p>
        </div>
        <div class="relative w-32 h-32 mx-auto">
            <svg viewBox="0 0 100 100" class="w-full h-full">
                <rect x="10" y="10" width="80" height="80" fill="none" stroke="#3B82F6" stroke-width="2" />
                <!-- Hiro标记图案 -->
                <circle cx="50" cy="50" r="25" fill="#3B82F6" />
                <path d="M35,35 L65,35 L65,65 L35,65 Z" fill="white" />
                <circle cx="50" cy="50" r="10" fill="#3B82F6" />
            </svg>
            <div class="absolute inset-0 border-2 border-primary border-dashed rounded-lg animate-pulse"></div>
        </div>
    </div>
    
    <!-- 信息模态框 -->
    <div id="infoModal" class="fixed inset-0 bg-black/80 z-50 flex items-center justify-center hidden">
        <div class="bg-gray-800 rounded-xl p-6 max-w-md w-full mx-4 transform transition-all">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-primary">关于此AR演示</h2>
                <button id="closeInfoBtn" class="text-gray-400 hover:text-white">
                    <i class="fa fa-times"></i>
                </button>
            </div>
            <div class="space-y-4 text-gray-300">
                <p>
                    这是一个使用AR.js和A-Frame构建的增强现实演示，专为前端开发者转岗AR领域设计。
                </p>
                <p>
                    技术栈包括：
                    <ul class="list-disc pl-5 mt-2 space-y-1">
                        <li>AR.js - 用于标记识别和跟踪</li>
                        <li>A-Frame - 构建3D场景</li>
                        <li>Three.js - 底层3D渲染</li>
                        <li>Tailwind CSS - 样式设计</li>
                    </ul>
                </p>
                <p>
                    适合在面试中展示你对新兴技术的学习能力和快速上手能力。
                </p>
            </div>
            <div class="mt-6">
                <button id="closeModalBtn" class="w-full bg-primary hover:bg-primary/90 text-white py-2 rounded-lg transition-colors">
                    了解了
                </button>
            </div>
        </div>
    </div>

    <script>
        // 等待场景加载完成
        document.querySelector('a-scene').addEventListener('loaded', function() {
            // 隐藏加载提示
            setTimeout(() => {
                document.getElementById('markerHint').classList.add('opacity-0', 'transition-opacity', 'duration-1000');
            }, 3000);
        });

        // 标记检测状态
        const marker = document.querySelector('a-marker');
        const markerHint = document.getElementById('markerHint');
        
        marker.addEventListener('markerFound', function() {
            markerHint.classList.add('hidden');
        });
        
        marker.addEventListener('markerLost', function() {
            markerHint.classList.remove('hidden');
            markerHint.classList.remove('opacity-0');
        });

        // 信息模态框控制
        const infoBtn = document.getElementById('infoBtn');
        const closeInfoBtn = document.getElementById('closeInfoBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const infoModal = document.getElementById('infoModal');
        
        infoBtn.addEventListener('click', function() {
            infoModal.classList.remove('hidden');
            infoModal.classList.add('flex');
        });
        
        function closeModal() {
            infoModal.classList.add('hidden');
            infoModal.classList.remove('flex');
        }
        
        closeInfoBtn.addEventListener('click', closeModal);
        closeModalBtn.addEventListener('click', closeModal);
        
        // 点击模态框外部关闭
        infoModal.addEventListener('click', function(e) {
            if (e.target === infoModal) {
                closeModal();
            }
        });

        // 切换AR会话
        const toggleARBtn = document.getElementById('toggleARBtn');
        toggleARBtn.addEventListener('click', function() {
            const scene = document.querySelector('a-scene');
            const arSystem = scene.systems['arjs'];
            
            if (arSystem && arSystem.arController) {
                arSystem.arController.reset();
                markerHint.classList.remove('hidden', 'opacity-0');
            }
        });

        // 移动端触摸旋转
        let touchStartX = 0;
        let currentRotationY = 0;
        const model = document.querySelector('[gltf-model]');
        
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length === 1 && model) {
                touchStartX = e.touches[0].clientX;
                currentRotationY = model.getAttribute('rotation').y;
            }
        }, false);
        
        document.addEventListener('touchmove', function(e) {
            if (e.touches.length === 1 && model) {
                const touchX = e.touches[0].clientX;
                const diffX = touchX - touchStartX;
                const newRotationY = currentRotationY + diffX * 0.5;
                
                model.setAttribute('rotation', { x: 0, y: newRotationY, z: 0 });
            }
        }, false);
    </script>
</body>
</html>    